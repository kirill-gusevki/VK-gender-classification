# VK-gender-classification
–î–∞—Ç–∞—Å–µ—Ç—ã –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç–µ - https://cups.online/ru/tasks/1923, (–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑-–∑–∞ –±–æ–ª—å—à–æ–≥–æ –≤–µ—Å–∞ —Ñ–∞–π–ª–æ–≤)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –¶–µ–ª—å ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö VK.

> **–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:** –ü–æ–≤—ã—à–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π –∑–∞ —Å—á—ë—Ç —Ç–æ—á–Ω–æ–≥–æ —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –ø–æ–ª—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
> **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞:** –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø–æ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `1` / `0`)  
> **–ú–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞:** AUC-ROC

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏:** AUC-ROC = `0.8904`
- **–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:** –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è URL, –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –±—Ä–∞—É–∑–µ—Ä –∏ –û–° –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|-----------|------------|
| **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è** | Python 3.9+ |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** | Pandas, NumPy |
| **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** | Scikit-learn, LightGBM |
| **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** | Matplotlib, Seaborn |
| **–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏** | JSON, CSV |
| **–£—Ç–∏–ª–∏—Ç—ã** | Jupyter Notebook, Joblib |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```python
VK-Gender-Prediction/
‚îú‚îÄ‚îÄ data/ # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)
‚îú‚îÄ‚îÄ notebooks/
‚îÇ ‚îî‚îÄ‚îÄ VK.ipynb # –ü–æ–ª–Ω—ã–π Jupyter Notebook —Å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º
‚îú‚îÄ‚îÄ src/
‚îÇ ‚îú‚îÄ‚îÄ data_processing.py # –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ ‚îú‚îÄ‚îÄ feature_engineering.py # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ ‚îî‚îÄ‚îÄ modeling.py # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ models/
‚îÇ ‚îú‚îÄ‚îÄ gender_prediction_model.joblib # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ ‚îî‚îÄ‚îÄ feature_names.json # –°–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îú‚îÄ‚îÄ results/
‚îÇ ‚îî‚îÄ‚îÄ gender_prediction_submission.csv # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îî‚îÄ‚îÄ README.md
```

## üßÆ –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
train_labels = pd.read_csv("train_labels.csv", sep=";")
train = pd.read_csv("train.csv", sep=";", on_bad_lines='skip')
geo_info = pd.read_csv("geo_info.csv", sep=";", dtype=str)
referer_vectors = pd.read_csv("referer_vectors.csv", sep=";")

# –ü–∞—Ä—Å–∏–Ω–≥ user_agent
def parse_user_agent(ua_str):
    ua_str = ua_str.replace("'", '"').replace('None', '"None"')
    return literal_eval(ua_str)
```

### 2. Feature Engineering
**–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**: —á–∞—Å, –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, –≤—Ä–µ–º—è —Å—É—Ç–æ–∫ (–Ω–æ—á—å/—É—Ç—Ä–æ/–¥–µ–Ω—å/–≤–µ—á–µ—Ä)

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ User Agent**: –±—Ä–∞—É–∑–µ—Ä, –û–°, –≤–µ—Ä—Å–∏—è, –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

**–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**: —Å—Ç—Ä–∞–Ω–∞, —Ä–µ–≥–∏–æ–Ω, —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ URL**: –¥–æ–º–µ–Ω, –ø—É—Ç—å, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø—É—Ç–∏

**–í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**: 10 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ referer_vectors

### 3. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```python
# –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
user_features = df.groupby('user_id').agg({
    'is_ios': ['mean', 'sum'],
    'browser': ['nunique', lambda x: x.mode()[0]],
    'hour': ['mean', 'std'],
    # ... –¥—Ä—É–≥–∏–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
})
```

### 4. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏
```python
# –û–±—É—á–µ–Ω–∏–µ LightGBM —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
params = {
    'objective': 'binary',
    'metric': 'auc',
    'boosting_type': 'gbdt',
    'num_leaves': 63,
    'learning_rate': 0.05,
}

model = lgb.train(params, train_data, num_boost_round=1000,
                 valid_sets=[val_data], callbacks=[lgb.early_stopping(50)])
```

### 5. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
5 –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

- **component2_mean** (0.089)

- **component3_mean** (0.083)

- **component8_mean** (0.079)

- **component1_mean** (0.078)

- **avg_hour** (0.071)

## –ö–æ–Ω—Ç–∞–∫—Ç—ã
**–ê–≤—Ç–æ—Ä:** –ì—É—Å–µ–≤ –ö–∏—Ä–∏–ª–ª
**Telegram:** @KiKmEp
**Email:** kirill-gusevki@yandex.ru
