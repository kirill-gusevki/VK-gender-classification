# VK-gender-classification
–î–∞—Ç–∞—Å–µ—Ç—ã –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç–µ - https://cups.online/ru/tasks/1923, (–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑-–∑–∞ –±–æ–ª—å—à–æ–≥–æ –≤–µ—Å–∞ —Ñ–∞–π–ª–æ–≤)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –æ—Ç –±–∏–∑–Ω–µ—Å-—é–Ω–∏—Ç–∞ **"–†–µ–∫–ª–∞–º–∞" –∫–æ–º–ø–∞–Ω–∏–∏ VK**. –¶–µ–ª—å ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö VK, –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏ –∏ –î–∑–µ–Ω.

> **–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:** –ü–æ–≤—ã—à–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π –∑–∞ —Å—á—ë—Ç —Ç–æ—á–Ω–æ–≥–æ —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –ø–æ–ª—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
> **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞:** –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø–æ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `1` / `0`)  
> **–ú–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞:** AUC-ROC

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏:** AUC-ROC = `0.8904`
- **–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:** –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è URL, –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –±—Ä–∞—É–∑–µ—Ä –∏ –û–° –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.joblib` —Å –ø–æ–ª–Ω—ã–º –ø–∞–π–ø–ª–∞–π–Ω–æ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|-----------|------------|
| **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è** | Python 3.9+ |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** | Pandas, NumPy |
| **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** | Scikit-learn, LightGBM |
| **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** | Matplotlib, Seaborn |
| **–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏** | JSON, CSV |
| **–£—Ç–∏–ª–∏—Ç—ã** | Jupyter Notebook, Joblib |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
VK-Gender-Prediction/
‚îú‚îÄ‚îÄ data/                    # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ VK_Gender_Prediction.ipynb  # –ü–æ–ª–Ω—ã–π Jupyter Notebook —Å –∫–æ–¥–æ–º
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ gender_prediction_model.joblib    # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ feature_names.json                # –°–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ results/
‚îÇ   ‚îî‚îÄ‚îÄ gender_prediction_submission.csv  # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
‚îî‚îÄ‚îÄ README.md

## üßÆ –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
train_labels = pd.read_csv("train_labels.csv", sep=";")
train = pd.read_csv("train.csv", sep=";", on_bad_lines='skip')
geo_info = pd.read_csv("geo_info.csv", sep=";", dtype=str)
referer_vectors = pd.read_csv("referer_vectors.csv", sep=";")

# –ü–∞—Ä—Å–∏–Ω–≥ user_agent
def parse_user_agent(ua_str):
    ua_str = ua_str.replace("'", '"').replace('None', '"None"')
    return literal_eval(ua_str)
